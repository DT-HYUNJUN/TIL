# 스케줄링

## 스케줄링의 정의

스케줄링은 준비상태에 있는 여러 개의 프로세스들 중에서 하나의 프로세스를 선정하여 CPU를 할당하는 것이다.

이러한 기능을 담당하는 스케줄러는 하나의 프로세스를 선정하는 스케줄링 정책 부분과 선정된 프로세스에게 CPU를 할당하는 디스패처 부분으로 구성된다.

```스케줄러 = 스케줄링 정책 + 디스패처```

또한 여러 개의 준비상태 프로세스를 관리하기 위한 준ㅂ비 큐를 유지한다.

결국 프로세스 스케줄링이란

`준비 큐에 등록된 여러 개의 프로세스들 중에서 스케줄링 정책에 따라 하나의 프로세스를 선정하고 선정된 프로세스에게 CPU를 할당하는 것`이라고 정의할 수 있다.

## 선점/비선점

모든 스케줄링 정책들은 선점 혹은 비선점으로 구분된다.

1. 실행 중인 프로세스가 종료될 경우
2. 실행 중인 프로세스가 대기 상태로 전환될 경우
3. 실행 중인 프로세스가 준비 상태로 전환될 경우
4. 대기 상태인 프로세스가 준비 상태로 전환될 경우
5. 새로운 프로세스가 생성될 경우

비선점 스케줄링은 1,2 경우에만 스케줄링이 발생하고

선점 스케줄링은 1,2 는 물론 3,4,5의 경우에도 발생한다.

이와 같이 비선점의 경우에는 어떤 프로세스가 CPU를 할당받으면 자발적으로 CPU 사용권을 내놓을 때까지 CPU 사용권이 보장된다.

그러나 선점의 경우에는 CPU 사용권이 강제적으로 빼앗길 수가 있다.

### 비선점

- 선입 선처리(FCFS: First-Come First-Served) 스케줄링

FCFS는 가장 먼저 준비 큐에 등록된 프로세스를 선정하는 전형적인 비선점 정책이다.

이 때 유의할 점은 프로세스 생성 순서가 아닌 준비 큐에 등록된 순서라는 것이다.

프로세스(P1, P2, P3)가 있다고 가정하자

```md
프로세스        CPU 사용시간(초)
P1                    13
P2                    4
P3                    2
```

준비 큐에 등록된 순서가 P1, P2, P3라고 하면, 프로세스가 처리되는 순서는 P1, P2, P3이고 각 프로세스의 대기시간과 평균 대기시간은 다음과 같이 계산한다.

```md
P1의 대기시간 = 0초
P2의 대기시간 = 13초
P3의 대기시간 = 17초
평균 대기시간 = (0 + 13 + 17) / 3 = 10(초)
```

한편 준비 큐에 등록된 순서가 P2, P1, P3라고 가정하면 각 프로세스의 대기시간과 평균 대기시간은 다음과 같이 계산한다.

```md
P2의 대기시간 = 0초
P1의 대기시간 = 4초
P3의 대기시간 = 17초
평균 대기시간 = (0 + 4 + 17) / 3 = 7(초)
```

이렇듯 FCFS 스케줄링은 매우 간단하지만 CPU 사용시간이 긴 프로세스가 다른 프로세스들을 오랫동안 기다리게 하는 호송 효과(convoy effect)가 발생할 수 있다.

- 최단 작업 선처리(SJF: Shortest Job First) 스케줄링

SJF는 준비 큐에 등록된 프로세스들 중에서 CPU 사용시간이 가장 짧은 프로세스를 선정하는 비선점 스케줄링 정책이다.

때문에 호송효과를 방지할 뿐만 아니라 최소 평균 대기시간을 보장할 수 있다.

```md
프로세스        CPU 사용시간(초)
P1                    13
P2                    4
P3                    2
```

이 경우 준비 큐에 등록된 프로세스 순서에 상관없이 이들이 처리되는 순서는 P3, P2, P1이고 대기시간은 다음과 같이 계산된다.

```md
P3의 대기시간 = 0초
P2의 대기시간 = 2초
P1의 대기시간 = 6초
평균 대기시간 = (0 + 2 + 6) / 3 = 2.667(초)
```

FCFS에 비하여 평균 대기시간이 훨씬 단축되었다.

그러나 정확한 CPU 사용시간의 예상이 불가능하기 때문에 SJF는 주로 다른 스케줄링 정책들의 평균 대기시간을 이론적으로 평가하기 위한 기준으로 이용된다.

- 우선순위 스케줄링

우선순위 스케줄링은 준비 큐에 등록된 프로세스들 중에서 우선순위가 가장 높은 프로세스를 선정하는 비선점 정책이다.